function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"1h0P":function(e,t,r){"use strict";r.r(t),r.d(t,"MessageModule",(function(){return xe}));var s={};r.r(s),r.d(s,"loadAcceptedMessageSuccess",(function(){return M})),r.d(s,"loadAcceptedMessageFailure",(function(){return O})),r.d(s,"loadMessagesSuccess",(function(){return _})),r.d(s,"loadMessagesFailure",(function(){return S})),r.d(s,"sendMessageSuccess",(function(){return j})),r.d(s,"sendMessageFailure",(function(){return w})),r.d(s,"updateMessageSuccess",(function(){return E})),r.d(s,"updateMessageFailure",(function(){return k})),r.d(s,"createMessageSuccess",(function(){return I})),r.d(s,"createMessageFailure",(function(){return x})),r.d(s,"deleteMessageSuccess",(function(){return C})),r.d(s,"deleteMessageFailure",(function(){return T})),r.d(s,"acceptMessageSuccess",(function(){return A})),r.d(s,"acceptMessageFailure",(function(){return L}));var n={};r.r(n),r.d(n,"loadAcceptedMessage",(function(){return P})),r.d(n,"setCurrrentRequest",(function(){return F})),r.d(n,"loadMessages",(function(){return q})),r.d(n,"sendMessage",(function(){return U})),r.d(n,"clearCurrrentRequest",(function(){return D})),r.d(n,"initCurrentMessage",(function(){return R})),r.d(n,"setDirty",(function(){return z})),r.d(n,"updateMessage",(function(){return $})),r.d(n,"createMessage",(function(){return H})),r.d(n,"deleteMessage",(function(){return B})),r.d(n,"acceptMessage",(function(){return N}));var o,i,c=r("iInd"),a=r("Yml6"),u=r("DQLy"),l=r("PCNd"),b=r("HDdC"),d=r("ds6q"),p=r("lJxs"),f=r("8Y7J"),h=((o=function(){function e(){_classCallCheck(this,e),this.messages=this.connect("ws://lobster-app-tgcy3.ondigitalocean.app").pipe(Object(p.a)((function(e){return JSON.parse(e.data)})))}return _createClass(e,[{key:"connect",value:function(e){return this.subject||(this.subject=this.create(e),console.log("Successfully connected: "+e)),this.subject}},{key:"create",value:function(e){var t=new WebSocket(e),r=new b.a((function(e){return t.onmessage=e.next.bind(e),t.onerror=e.error.bind(e),t.onclose=e.complete.bind(e),t.close.bind(t)}));return new d.AnonymousSubject({error:null,complete:null,next:function(e){console.log("Message sent to websocket: ",e),t.readyState===WebSocket.OPEN&&t.send(JSON.stringify(e))}},r)}}]),e}()).\u0275fac=function(e){return new(e||o)},o.\u0275prov=f.Fb({token:o,factory:o.\u0275fac,providedIn:"root"}),o),g=Object(u.o)("messages"),y=Object(u.q)(g,(function(e){return e.currentRequestId})),m=(Object(u.q)(g,y,(function(e,t){return t?e.messages.find((function(e){return e.id===t})):null})),Object(u.q)(g,(function(e){return e.messages}))),v=Object(u.q)(g,(function(e){return e.acceptedMessages})),M=(Object(u.q)(g,(function(e){return e.error})),Object(u.n)("[Message List API] Load Accepted Message Success",Object(u.s)())),O=Object(u.n)("[Message List API] Load Accepted Message Fail",Object(u.s)()),_=Object(u.n)("[Message Chat API] Load Messages Success",Object(u.s)()),S=Object(u.n)("[Message Chat API] Load Messages Fail",Object(u.s)()),j=Object(u.n)("[Message Chat API] Save Messages Success",Object(u.s)()),w=Object(u.n)("[Message Chat API] Save Messages Fail",Object(u.s)()),E=Object(u.n)("[Message Edit API] Update Message Success",Object(u.s)()),k=Object(u.n)("[Message Edit API] Update Message Fail",Object(u.s)()),I=Object(u.n)("[Message New API] Create Message Success",Object(u.s)()),x=Object(u.n)("[Message New API] Create Message Fail",Object(u.s)()),C=Object(u.n)("[Message List API] Delete Message Success",Object(u.s)()),T=Object(u.n)("[Message List API] Delete Message Fail",Object(u.s)()),A=Object(u.n)("[Message List API] Accept Message Success",Object(u.s)()),L=Object(u.n)("[Message List API] Accept Message Fail",Object(u.s)()),P=Object(u.n)("[Message List Page] Load Accepted Message"),F=Object(u.n)("[Message List Page] Set Current Request",Object(u.s)()),q=Object(u.n)("[Message Chat Page] Load Messages",Object(u.s)()),U=Object(u.n)("[Message Chat Page] Send Messages",Object(u.s)()),D=Object(u.n)("[Message Edit Page] Clear Current Request"),R=Object(u.n)("[Message List Page] Initialize Current Message"),z=Object(u.n)("[Product Edit Page] Set Product Dirty",Object(u.s)()),$=Object(u.n)("[Message Edit Page] Update Message",Object(u.s)()),H=Object(u.n)("[Message New Page] Create Message",Object(u.s)()),B=Object(u.n)("[Message List Page] Delete Message",Object(u.s)()),N=Object(u.n)("[Message List Page] Accept Message",Object(u.s)()),J=r("lGQG"),W=r("z6cu"),G=r("JIr8"),V=r("IheW"),Y=((i=function(){function e(t,r){_classCallCheck(this,e),this.http=t,this.authService=r,this.requestUrl="https://cyberron.somee.com/api/message"}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"getAcceptedMessage",value:function(){return this.http.post(this.requestUrl+"/allacceptedrequest",{token:this.authService.appToken,userId:this.authService.currentUserId,userType:this.authService.userType}).pipe(Object(G.a)(this.handleError))}},{key:"getMessages",value:function(e){return this.http.post(this.requestUrl+"/getmessages",{userType:this.authService.userType,requestId:e,token:this.authService.appToken,userId:this.authService.currentUserId}).pipe(Object(G.a)(this.handleError))}},{key:"savingMessage",value:function(e){return this.http.post(this.requestUrl+"/savemessage",{requestId:e.request_id,userId:this.authService.currentUserId,userType:this.authService.userType,message:e.message,token:this.authService.appToken}).pipe(Object(G.a)(this.handleError))}},{key:"handleError",value:function(e){var t;return t=e.error instanceof ErrorEvent?"An error occurred: "+e.error.message:"Backend returned code ".concat(e.status,": ").concat(e.body.error),console.error(e),Object(W.a)(t)}}]),e}()).\u0275fac=function(e){return new(e||i)(f.Qb(V.a),f.Qb(J.a))},i.\u0275prov=f.Fb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),Q=r("SVse"),X=function(e){return{active:e}};function K(e,t){if(1&e){var r=f.Nb();f.Mb(0,"li",7),f.Ub("click",(function(){f.fc(r);var e=t.$implicit,s=t.index;return f.Wb().openMessage(e.request_id,s)})),f.Mb(1,"div",8),f.Mb(2,"div",9),f.Kb(3,"div",10),f.kc(4),f.Lb(),f.kc(5),f.Kb(6,"br"),f.kc(7),f.Lb(),f.Mb(8,"span",11),f.kc(9,"23"),f.Lb(),f.Lb()}if(2&e){var s=t.$implicit,n=t.index,o=f.Wb();f.ac("ngClass",f.bc(4,X,o.selectedItem===n)),f.zb(4),f.mc(" Client: ",s.client_username,""),f.zb(1),f.mc(" Title: ",s.title,""),f.zb(2),f.mc(" Last Message: ",s.message," ")}}var Z,ee,te=((Z=function(){function e(){_classCallCheck(this,e),this.openMessageEmit=new f.n,this.selectedItem=-1}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"openMessage",value:function(e,t){this.selectedItem=t,this.openMessageEmit.emit(e)}}]),e}()).\u0275fac=function(e){return new(e||Z)},Z.\u0275cmp=f.Db({type:Z,selectors:[["cc-message-list"]],inputs:{acceptedMessage:"acceptedMessage",userType:"userType",errorMessage:"errorMessage",selectedMesssage:"selectedMesssage"},outputs:{openMessageEmit:"openMessageEmit"},decls:10,vars:1,consts:[[1,"card"],[1,"card-header"],[1,"card-body",2,"height","40rem"],[1,"row"],[1,"col-md-12"],[1,"list-group"],["class","list-group-item d-flex justify-content-between align-items-start",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-start",3,"ngClass","click"],[1,"ms-2","me-auto"],[1,"fw-bold"],[1,"bold"],[1,"badge","bg-info","rounded-pill"]],template:function(e,t){1&e&&(f.Mb(0,"div"),f.Mb(1,"div",0),f.Mb(2,"div",1),f.Mb(3,"h4"),f.kc(4,"Accepted Request"),f.Lb(),f.Lb(),f.Mb(5,"div",2),f.Mb(6,"div",3),f.Mb(7,"div",4),f.Mb(8,"ul",5),f.ic(9,K,10,6,"li",6),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb()),2&e&&(f.zb(9),f.ac("ngForOf",t.acceptedMessage))},directives:[Q.k,Q.j],styles:["li[_ngcontent-%COMP%]{font-size:14px;cursor:pointer;text-decoration:none;color:#000;padding:8px}.active[_ngcontent-%COMP%], li[_ngcontent-%COMP%]:hover{color:#000;background-color:#90c2f0}.list-group[_ngcontent-%COMP%]{max-height:597px;margin-bottom:10px;overflow-y:auto;-webkit-overflow-scrolling:touch}"]}),Z),re=r("s7LF"),se=r("XNiG"),ne=r("QEVK"),oe=r("2Vo4"),ie=r("DH7j"),ce=r("n6bG"),ae=r("1G5W"),ue=r("Kj3r"),le=((ee=function(){function e(t){_classCallCheck(this,e),this.self=t,this.stayAtBottom=!0,this.scrollNow=new se.a,this.amScrolledToBottom=new b.a,this.destroy$=new se.a,this.mutations=new oe.a(null),this._userScrolledUp=new oe.a(!1)}return _createClass(e,[{key:"ngOnChanges",value:function(){!0===this.stayAtBottom&&this.scrollToBottom()}},{key:"ngAfterViewInit",value:function(){this.registerScrollHandlers()}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),null!=this.changes&&this.changes.disconnect()}},{key:"registerScrollHandlers",value:function(){var e=this;this.amScrolledToBottom=this._userScrolledUp.pipe(Object(ae.a)(this.destroy$),Object(p.a)((function(e){return!e}))),new MutationObserver((function(){return e.mutations.next(null)})).observe(this.self.nativeElement,{attributes:!0,childList:!0,characterData:!0}),this.scrollEvent=function e(t,r,s,n){return Object(ce.a)(s)&&(n=s,s=void 0),n?e(t,r,s).pipe(Object(p.a)((function(e){return Object(ie.a)(e)?n.apply(void 0,_toConsumableArray(e)):n(e)}))):new b.a((function(e){!function e(t,r,s,n,o){var i;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(t)){var c=t;t.addEventListener(r,s,o),i=function(){return c.removeEventListener(r,s,o)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(t)){var a=t;t.on(r,s),i=function(){return a.off(r,s)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(t)){var u=t;t.addListener(r,s),i=function(){return u.removeListener(r,s)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var l=0,b=t.length;l<b;l++)e(t[l],r,s,n,o)}n.add(i)}(t,r,(function(t){e.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),e,s)}))}(this.self.nativeElement,"scroll").pipe(Object(ae.a)(this.destroy$),Object(ue.a)(100)),this.scrollNow.pipe(Object(ae.a)(this.destroy$)).subscribe((function(t){e.scrollToBottom()})),this.mutations.pipe(Object(ae.a)(this.destroy$)).subscribe((function(t){!1===e._userScrolledUp.value&&e.scrollToBottom()})),this.scrollEvent.pipe(Object(ae.a)(this.destroy$)).subscribe((function(t){e.setHasUserScrolledUp()}))}},{key:"setHasUserScrolledUp",value:function(){var e=this,t=this.self.nativeElement;t.scrollHeight===t.clientHeight+t.scrollTop!=1?!0!==this._userScrolledUp.value&&setTimeout((function(){t.scrollHeight===t.clientHeight+t.scrollTop==0&&e._userScrolledUp.next(!0)}),5):this._userScrolledUp.next(!1)}},{key:"scrollToBottom",value:function(){var e=this;setTimeout((function(){return e.self.nativeElement.scrollTo({left:0,top:e.self.nativeElement.scrollHeight,behavior:"smooth"})}),0)}}]),e}()).\u0275fac=function(e){return new(e||ee)(f.Jb(f.l))},ee.\u0275dir=f.Eb({type:ee,selectors:[["","appScrollToBottom",""]],inputs:{stayAtBottom:"stayAtBottom",scrollNow:["scrollNow$s","scrollNow"]},outputs:{amScrolledToBottom:"amScrolledToBottom"},features:[f.xb]}),ee),be=["autoFocus"],de=function(e,t){return{"text-right":e,"text-left":t}},pe=function(e,t){return{darker:e,light:t}};function fe(e,t){if(1&e&&(f.Mb(0,"div"),f.Mb(1,"div",15),f.kc(2),f.Lb(),f.Mb(3,"div",16),f.Mb(4,"p",17),f.kc(5),f.Lb(),f.Mb(6,"span",18),f.kc(7),f.Lb(),f.Lb(),f.Lb()),2&e){var r=t.$implicit,s=f.Wb();f.zb(1),f.ac("ngClass",f.cc(5,de,s.currentUserId===r.created_by_id,s.currentUserId!==r.created_by_id)),f.zb(1),f.lc(r.created_fullname),f.zb(1),f.ac("ngClass",f.cc(8,pe,s.currentUserId===r.created_by_id,s.currentUserId!==r.created_by_id)),f.zb(2),f.lc(r.message),f.zb(2),f.lc(r.created_date)}}function he(e,t){if(1&e&&(f.Mb(0,"span",19),f.kc(1),f.Lb()),2&e){var r=f.Wb();f.zb(1),f.mc(" ",r.displayMessage.message," ")}}var ge,ye,me,ve,Me=function(e){return{"is-invalid":e}},Oe=((ye=function(){function e(t,r){_classCallCheck(this,e),this.socketService=t,this.fb=r,this.sendMessageEmit=new f.n,this.messageElementEmit=new f.n,this.reloadMessageEmit=new f.n,this.displayMessage={},this.scrollNow=new se.a,this.validationMessages={message:{required:"Message is required.",minlength:"Message must be at least three characters.",maxlength:"Message cannot exceed 5000 characters."}},this.genericValidator=new ne.a(this.validationMessages)}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.messageForm=this.fb.group({message:["",[re.m.required,re.m.minLength(3),re.m.maxLength(5e3)]]}),this.messageForm.valueChanges.subscribe((function(){return e.displayMessage=e.genericValidator.processMessages(e.messageForm)})),this.socketService.messages.subscribe((function(t){var r=Object.assign({},t);e.currentUserId!==r.user_id&&e.requestId===r.request_id&&e.reloadMessageEmit.emit(r.request_id),console.log("Response from websocket: "+JSON.stringify(r)),e.scrollNow.next(!0)}))}},{key:"ngOnDestroy",value:function(){}},{key:"ngAfterViewChecked",value:function(){null!==this.messages&&this.autoFocus.nativeElement.focus()}},{key:"displayUpdatedMessage",value:function(e){}},{key:"blur",value:function(){this.displayMessage=this.genericValidator.processMessages(this.messageForm)}},{key:"sendMessage",value:function(){this.sendMessageEmit.emit(this.messageForm.get("message").value);var e={user_id:this.currentUserId,request_id:this.requestId,message:this.messageForm.get("message").value};this.socketService.messages.next(e),this.messageForm.reset(),this.scrollNow.next(!0),this.autoFocus.nativeElement.focus()}}]),e}()).\u0275fac=function(e){return new(e||ye)(f.Jb(h),f.Jb(re.b))},ye.\u0275cmp=f.Db({type:ye,selectors:[["cc-message-chat"]],viewQuery:function(e,t){var r;1&e&&f.nc(be,!0),2&e&&f.dc(r=f.Vb())&&(t.autoFocus=r.first)},inputs:{messages:"messages",userType:"userType",requestId:"requestId",currentUserId:"currentUserId",errorMessage:"errorMessage"},outputs:{sendMessageEmit:"sendMessageEmit",messageElementEmit:"messageElementEmit",reloadMessageEmit:"reloadMessageEmit"},decls:22,vars:10,consts:[[1,"card"],[1,"card-header"],["appScrollToBottom","","cdkScrollable","",1,"card-body",2,"height","28rem",3,"scrollNow$s","stayAtBottom"],["myList",""],[4,"ngFor","ngForOf"],[1,"card-footer"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row","g-3","align-items-center"],[1,"col-auto"],["for","inputMessage",1,"col-form-label"],["id","sendMessageId","placeholder","Type your message here...","rows","3","cols","80","formControlName","message",1,"form-control",3,"ngClass"],["autoFocus",""],["class","invalid-feedback",4,"ngIf"],[1,"col-auto","mt-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"fullname",3,"ngClass"],[1,"msg-container",3,"ngClass"],[1,"msg"],[1,"time-message"],[1,"invalid-feedback"]],template:function(e,t){1&e&&(f.Mb(0,"div"),f.Mb(1,"div",0),f.Mb(2,"div",1),f.Mb(3,"h4"),f.kc(4,"Message"),f.Lb(),f.Lb(),f.Mb(5,"div",2,3),f.ic(7,fe,8,11,"div",4),f.Lb(),f.Mb(8,"div",5),f.Mb(9,"form",6),f.Ub("ngSubmit",(function(){return t.sendMessage()})),f.Mb(10,"div",7),f.Mb(11,"div",8),f.Mb(12,"label",9),f.kc(13,"Message"),f.Lb(),f.Lb(),f.Mb(14,"div",8),f.Mb(15,"textarea",10,11),f.kc(17,"                "),f.Lb(),f.ic(18,he,2,1,"span",12),f.Lb(),f.Mb(19,"div",13),f.Mb(20,"button",14),f.kc(21,"Send"),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb()),2&e&&(f.zb(5),f.ac("scrollNow$s",t.scrollNow)("stayAtBottom",!0),f.zb(2),f.ac("ngForOf",t.messages),f.zb(2),f.ac("formGroup",t.messageForm),f.zb(6),f.ac("ngClass",f.bc(8,Me,t.displayMessage.message)),f.Ab("disabled",null===t.messages?"disabled":null),f.zb(3),f.ac("ngIf",t.displayMessage.message),f.zb(2),f.ac("disabled",!t.messageForm.valid||!t.messageForm.dirty&&t.messages))},directives:[le,Q.k,re.n,re.h,re.e,re.a,re.g,re.c,Q.j,Q.l],styles:['.card-body[_ngcontent-%COMP%]{max-height:597px;margin-bottom:10px;overflow-y:auto;-webkit-overflow-scrolling:touch}.message[_ngcontent-%COMP%]{padding:10px}.msg-container[_ngcontent-%COMP%]{border:2px solid #dedede;border-radius:5px;padding:10px;margin:10px 0}.light[_ngcontent-%COMP%]{background-color:#f1f1f1;margin-right:80px}.darker[_ngcontent-%COMP%]{border-color:#ccc;background-color:#ddd;margin-left:80px}.msg-container[_ngcontent-%COMP%]:after{content:"";clear:both;display:table}.fullname[_ngcontent-%COMP%], .msg[_ngcontent-%COMP%]{font-size:14px}.time-message[_ngcontent-%COMP%]{font-size:10px}textarea[_ngcontent-%COMP%]{resize:none}']}),ye),_e=((ge=function(){function e(t,r,s,n){_classCallCheck(this,e),this.store=t,this.router=r,this.auth=s,this.messageService=n,this.pageTitle="Chat Box"}return _createClass(e,[{key:"ngOnInit",value:function(){this.userType=this.auth.userType,this.currentUserId=this.auth.currentUserId,this.store.dispatch(n.loadAcceptedMessage()),this.acceptedMessage$=this.store.select(v)}},{key:"openMessage",value:function(e){this.requestId=e,this.store.dispatch(n.setCurrrentRequest({currentRequestId:e})),this.store.dispatch(n.loadMessages({request_id:e})),this.messages$=this.store.select(m)}},{key:"reloadMessage",value:function(e){this.store.dispatch(n.loadMessages({request_id:e})),this.messages$=this.store.select(m)}},{key:"sendMessage",value:function(e){this.store.dispatch(n.sendMessage({request_id:this.requestId,message:e}))}}]),e}()).\u0275fac=function(e){return new(e||ge)(f.Jb(u.h),f.Jb(c.b),f.Jb(J.a),f.Jb(Y))},ge.\u0275cmp=f.Db({type:ge,selectors:[["ng-component"]],decls:10,vars:19,consts:[[1,"row"],[1,"col-md-5"],[3,"acceptedMessage","userType","selectedMesssage","errorMessage","openMessageEmit"],[1,"col-md-7"],[3,"messages","userType","requestId","currentUserId","errorMessage","sendMessageEmit","reloadMessageEmit"]],template:function(e,t){1&e&&(f.Mb(0,"div",0),f.Mb(1,"div",1),f.Mb(2,"cc-message-list",2),f.Ub("openMessageEmit",(function(e){return t.openMessage(e)})),f.Xb(3,"async"),f.Xb(4,"async"),f.Xb(5,"async"),f.Lb(),f.Lb(),f.Mb(6,"div",3),f.Mb(7,"cc-message-chat",4),f.Ub("sendMessageEmit",(function(e){return t.sendMessage(e)}))("reloadMessageEmit",(function(e){return t.reloadMessage(e)})),f.Xb(8,"async"),f.Xb(9,"async"),f.Lb(),f.Lb(),f.Lb()),2&e&&(f.zb(2),f.ac("acceptedMessage",f.Yb(3,9,t.acceptedMessage$))("userType",t.userType)("selectedMesssage",f.Yb(4,11,t.selectedMesssage$))("errorMessage",f.Yb(5,13,t.errorMessage$)),f.zb(5),f.ac("messages",f.Yb(8,15,t.messages$))("userType",t.userType)("requestId",t.requestId)("currentUserId",t.currentUserId)("errorMessage",f.Yb(9,17,t.errorMessage$)))},directives:[te,Oe],pipes:[Q.b],encapsulation:2}),ge),Se=r("LRne"),je=r("5+tZ"),we=r("bOdf"),Ee=((me=_createClass((function e(t,r){var o=this;_classCallCheck(this,e),this.actions$=t,this.messageService=r,this.loadAcceptedMessage$=Object(a.c)((function(){return o.actions$.pipe(Object(a.d)(n.loadAcceptedMessage),Object(je.a)((function(){return o.messageService.getAcceptedMessage().pipe(Object(p.a)((function(e){return s.loadAcceptedMessageSuccess({acceptedMessages:e})})),Object(G.a)((function(e){return Object(Se.a)(s.loadAcceptedMessageFailure({error:e}))})))})))})),this.loadMessages$=Object(a.c)((function(){return o.actions$.pipe(Object(a.d)(n.loadMessages),Object(je.a)((function(e){return o.messageService.getMessages(e.request_id).pipe(Object(p.a)((function(e){return s.loadMessagesSuccess({messages:e})})),Object(G.a)((function(e){return Object(Se.a)(s.loadMessagesFailure({error:e}))})))})))})),this.saveMessages$=Object(a.c)((function(){return o.actions$.pipe(Object(a.d)(n.sendMessage),Object(we.a)((function(e){return o.messageService.savingMessage(e).pipe(Object(p.a)((function(e){return s.sendMessageSuccess({messages:e})})),Object(G.a)((function(e){return Object(Se.a)(s.sendMessageFailure({error:e}))})))})))}))}))).\u0275fac=function(e){return new(e||me)(f.Qb(a.a),f.Qb(Y))},me.\u0275prov=f.Fb({token:me,factory:me.\u0275fac,providedIn:"root"}),me),ke=Object(u.p)({currentRequestId:null,isDirty:!1,error:"",acceptedMessages:[],messages:[]},Object(u.r)(n.setCurrrentRequest,(function(e,t){return Object.assign(Object.assign({},e),{currentRequestId:t.currentRequestId,error:"",isDirty:!1})})),Object(u.r)(n.clearCurrrentRequest,(function(e){return Object.assign(Object.assign({},e),{currentRequestId:null,error:"",isDirty:!1})})),Object(u.r)(n.initCurrentMessage,(function(e){return Object.assign(Object.assign({},e),{currentRequestId:0,error:"",isDirty:!1})})),Object(u.r)(s.loadAcceptedMessageSuccess,(function(e,t){return Object.assign(Object.assign({},e),{error:"",currentRequestId:0,acceptedMessages:t.acceptedMessages})})),Object(u.r)(s.loadAcceptedMessageFailure,(function(e,t){return Object.assign(Object.assign({},e),{error:t.error,currentRequestId:0,acceptedMessages:[]})})),Object(u.r)(s.loadMessagesSuccess,(function(e,t){return Object.assign(Object.assign({},e),{error:"",currentRequestId:0,messages:t.messages})})),Object(u.r)(s.loadMessagesFailure,(function(e,t){return Object.assign(Object.assign({},e),{error:t.error,currentRequestId:0,messages:[]})})),Object(u.r)(s.sendMessageSuccess,(function(e,t){return Object.assign(Object.assign({},e),{error:"",currentRequestId:0,messages:t.messages})})),Object(u.r)(s.sendMessageFailure,(function(e,t){return Object.assign(Object.assign({},e),{error:t.error,currentRequestId:0})})),Object(u.r)(n.setDirty,(function(e,t){return Object.assign(Object.assign({},e),{isDirty:t.isDirty})}))),Ie=[{path:"",component:_e}],xe=((ve=_createClass((function e(){_classCallCheck(this,e)}))).\u0275mod=f.Hb({type:ve}),ve.\u0275inj=f.Gb({factory:function(e){return new(e||ve)},providers:[h],imports:[[l.a,c.e.forChild(Ie),u.j.forFeature("messages",ke),a.b.forFeature([Ee])]]}),ve)},"9AGB":function(e,t,r){"use strict";var s=r("yoF8");function n(e){return 0===e.length?s.identity:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n(e)},t.pipeFromArray=n},FWf1:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=r("pshJ"),i=r("GiSu"),c=r("zB/H"),a=r("p//D"),u=r("n3uD"),l=r("MkmW"),b=function(e){function t(r,s,n){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=i.empty;break;case 1:if(!r){o.destination=i.empty;break}if("object"==typeof r){r instanceof t?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new d(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new d(o,r,s,n)}return o}return n(t,e),t.prototype[a.rxSubscriber]=function(){return this},t.create=function(e,r,s){var n=new t(e,r,s);return n.syncErrorThrowable=!1,n},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(c.Subscription);t.Subscriber=b;var d=function(e){function t(t,r,s,n){var c,a=e.call(this)||this;a._parentSubscriber=t;var u=a;return o.isFunction(r)?c=r:r&&(c=r.next,s=r.error,n=r.complete,r!==i.empty&&(u=Object.create(r),o.isFunction(u.unsubscribe)&&a.add(u.unsubscribe.bind(u)),u.unsubscribe=a.unsubscribe.bind(a))),a._context=u,a._next=c,a._error=s,a._complete=n,a}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;u.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=u.config.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):l.hostReportError(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;l.hostReportError(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};u.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(r){if(this.unsubscribe(),u.config.useDeprecatedSynchronousErrorHandling)throw r;l.hostReportError(r)}},t.prototype.__tryOrSetError=function(e,t,r){if(!u.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(s){return u.config.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=s,e.syncErrorThrown=!0,!0):(l.hostReportError(s),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(b);t.SafeSubscriber=d},FiyT:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.SubjectSubscription=function(e){function t(t,r){var s=e.call(this)||this;return s.subject=t,s.subscriber=r,s.closed=!1,s}return n(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},t}(r("zB/H").Subscription)},GMZp:function(e,t,r){"use strict";t.isObject=function(e){return null!==e&&"object"==typeof e}},GiSu:function(e,t,r){"use strict";var s=r("n3uD"),n=r("MkmW");t.empty={closed:!0,next:function(e){},error:function(e){if(s.config.useDeprecatedSynchronousErrorHandling)throw e;n.hostReportError(e)},complete:function(){}}},LBXl:function(e,t,r){"use strict";t.UnsubscriptionError=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}()},MkmW:function(e,t,r){"use strict";t.hostReportError=function(e){setTimeout((function(){throw e}),0)}},Mxlh:function(e,t,r){"use strict";t.ObjectUnsubscribedError=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}()},Q1FS:function(e,t,r){"use strict";var s=r("yx2s"),n=r("Xwq/"),o=r("zfKp"),i=r("9AGB"),c=r("n3uD");function a(e){if(e||(e=c.config.Promise||Promise),!e)throw new Error("no Promise impl found");return e}t.Observable=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var s=this.operator,o=n.toSubscriber(e,t,r);if(o.add(s?s.call(o,this.source):this.source||c.config.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),c.config.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){c.config.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),s.canReportError(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=a(t))((function(t,s){var n;n=r.subscribe((function(t){try{e(t)}catch(r){s(r),n&&n.unsubscribe()}}),s,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[o.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:i.pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=a(e))((function(e,r){var s;t.subscribe((function(e){return s=e}),(function(e){return r(e)}),(function(){return e(s)}))}))},e.create=function(t){return new e(t)},e}()},"Xwq/":function(e,t,r){"use strict";var s=r("FWf1"),n=r("p//D"),o=r("GiSu");t.toSubscriber=function(e,t,r){if(e){if(e instanceof s.Subscriber)return e;if(e[n.rxSubscriber])return e[n.rxSubscriber]()}return e||t||r?new s.Subscriber(e,t,r):new s.Subscriber(o.empty)}},ds6q:function(e,t,r){"use strict";var s,n=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=r("Q1FS"),i=r("FWf1"),c=r("zB/H"),a=r("Mxlh"),u=r("FiyT"),l=r("p//D"),b=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return n(t,e),t}(i.Subscriber);t.SubjectSubscriber=b;var d=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return n(t,e),t.prototype[l.rxSubscriber]=function(){return new b(this)},t.prototype.lift=function(e){var t=new p(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,r=t.length,s=t.slice(),n=0;n<r;n++)s[n].next(e)},t.prototype.error=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,s=t.slice(),n=0;n<r;n++)s[n].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new a.ObjectUnsubscribedError;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),s=0;s<t;s++)r[s].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),c.Subscription.EMPTY):this.isStopped?(e.complete(),c.Subscription.EMPTY):(this.observers.push(e),new u.SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new o.Observable;return e.source=this,e},t.create=function(e,t){return new p(e,t)},t}(o.Observable);t.Subject=d;var p=function(e){function t(t,r){var s=e.call(this)||this;return s.destination=t,s.source=r,s}return n(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):c.Subscription.EMPTY},t}(d);t.AnonymousSubject=p},mbIT:function(e,t,r){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},n3uD:function(e,t,r){"use strict";var s=!1;t.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else s&&console.log("RxJS: Back to a better error behavior. Thank you. <3");s=e},get useDeprecatedSynchronousErrorHandling(){return s}}},"p//D":function(e,t,r){"use strict";t.rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),t.$$rxSubscriber=t.rxSubscriber},pshJ:function(e,t,r){"use strict";t.isFunction=function(e){return"function"==typeof e}},yoF8:function(e,t,r){"use strict";t.identity=function(e){return e}},yx2s:function(e,t,r){"use strict";var s=r("FWf1");t.canReportError=function(e){for(;e;){var t=e.destination;if(e.closed||e.isStopped)return!1;e=t&&t instanceof s.Subscriber?t:null}return!0}},"zB/H":function(e,t,r){"use strict";var s=r("mbIT"),n=r("GMZp"),o=r("pshJ"),i=r("LBXl");function c(e){return e.reduce((function(e,t){return e.concat(t instanceof i.UnsubscriptionError?t.errors:t)}),[])}t.Subscription=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this._parentOrParents,a=this._unsubscribe,u=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var l=0;l<r.length;++l)r[l].remove(this);if(o.isFunction(a))try{a.call(this)}catch(p){t=p instanceof i.UnsubscriptionError?c(p.errors):[p]}if(s.isArray(u)){l=-1;for(var b=u.length;++l<b;){var d=u[l];if(n.isObject(d))try{d.unsubscribe()}catch(p){t=t||[],p instanceof i.UnsubscriptionError?t=t.concat(c(p.errors)):t.push(p)}}}if(t)throw new i.UnsubscriptionError(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var s=r;(r=new e)._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var n=r._parentOrParents;if(null===n)r._parentOrParents=this;else if(n instanceof e){if(n===this)return r;r._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return r;n.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[r]:o.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=((t=new e).closed=!0,t),e}()},zfKp:function(e,t,r){"use strict";t.observable="function"==typeof Symbol&&Symbol.observable||"@@observable"}}]);